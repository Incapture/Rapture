/**
 * Copyright (C) 2011-2013 Incapture Technologies LLC
 *
 * This is an autogenerated license statement. When copyright notices appear below
 * this one that copyright supercedes this statement.
 *
 * Unless required by applicable law or agreed to in writing, software is distributed
 * on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied.
 *
 * Unless explicit permission obtained in writing this software cannot be distributed.
 */

/******************************************************
* This Reflex script will test the following Reflex built-in functions and keywords:
* - async calls
* - 
*/

require "//reflexTest.scriptstore/commonFuncs.rfx" as comm;

// init the params we pass in
if !defined(_params) do
	_params = {};
	_params['assertDocRepo'] =  '//reflexTest.validation/testRun';
	_params['assertRepo'] =  '//reflexTest.validation';
	_params['assertRepoConfig'] = 'NREP {} using MONGODB {prefix="validate.reflexTestData"}';	
	_params['date'] = 'today';
	_params['docRepoURI'] = '//someAuthority.testingReflex';
	_params['config'] = 'NREP {} using MONGODB {prefix="data.docData"}';
	_params['docPath'] = 'theDoc';
	 
end 

assertDocRepoURI = _params['assertDocRepo'];
assertRepoURI = _params['assertRepo'];
assertConfig = _params['assertRepoConfig'];
TODAY = _params['date'];
docRepoConfig = _params['config']; 
docPath = _params['docPath'];
docRepoURI = _params['docRepoURI'];

//println("our params: " + docRepoURI );

//setup repos if they do not exist
//comm.init(assertRepoURI, assertConfig, docRepoURI, docRepoConfig);

//resultsData = {};
//resultsData <-- assertDocRepoURI + '/05builtinAsync/'+TODAY;
//---------- test -----------

// run script positive
runResult={};
returnVal = false;

//SCRIPT_URI='//reflexintegration.scriptstore'; 
//VALID_SCRIPT_DOC_URI='script://reflexintegration.scriptstore/validScript'; 
//INVALID_SCRIPT_DOC_URI='script://reflexintegration.scriptstore/invalidScript'; 
//if !(#doc.doesDocumentRepoExist(SCRIPT_URI)) do   
//	#doc.createDocumentRepo(SCRIPT_URI,'NREP {} using MONGODB {prefix="validate.reflexTestData"}');
//end

//#script.deleteScript(VALID_SCRIPT_DOC_URI);
//#script.deleteScript(INVALID_SCRIPT_DOC_URI);
//#script.createScript(VALID_SCRIPT_DOC_URI,'REFLEX', 'PROGRAM', "println('hello world');");
//#script.createScript(INVALID_SCRIPT_DOC_URI,'REFLEX', 'PROGRAM', "INVALID;");

// complete when @callScript() is working
//@callscript (SCRIPT_URI,'validScript',{})


//---------- test validation ----------
    
//println ('Reporting results to: ' + assertDocRepoURI + '/05builtinAsync/'+TODAY);
//resultsData --> assertDocRepoURI + '/05builtinAsync/'+TODAY;
return returnVal;
