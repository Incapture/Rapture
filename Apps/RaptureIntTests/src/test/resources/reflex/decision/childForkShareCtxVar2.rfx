/**
 * Copyright (C) 2011-2013 Incapture Technologies LLC
 *
 * This is an autogenerated license statement. When copyright notices appear below
 * this one that copyright supercedes this statement.
 *
 * Unless required by applicable law or agreed to in writing, software is distributed
 * on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied.
 *
 * Unless explicit permission obtained in writing this software cannot be distributed.
 */

println('******* IN CHILDFORK2 STEP *******');
workerURI =  _params['$DP_WORKER_URI'];
workOrderURI = _params['$DP_WORK_ORDER_URI'];
println('******* DP_WORKER_URI    : ' + workerURI);
println('******* DP_WORK_ORDER_URI: ' + workOrderURI);

sleep(1000);
workOrderStatus = #decision.getWorkOrderStatus(workOrderURI);
println("******* Status is        : " + workOrderStatus);

//get doc repo uri and write a doc to it.
docRepo = #decision.getContextValue(workerURI,'docRepoUri');
println('******* Doc Repo Uri is  : ' + docRepo);

jsonStr = "{\"KeyFromChild2\":\"ValueFromChild2\"}";
x = #decision.getContextValue(workerURI,'randomNumber'); //x is a random number passed in from calling java workflow
docUri = docRepo + '/' + x + '/' + 'docFromFork2';
println('Writing ' + jsonStr + ' to ' + docUri); 
#doc.putDoc(docUri, jsonStr);

return "ok";